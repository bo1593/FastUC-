<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin - FastUC</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<header>
  <h1>لوحة التحكم</h1>
</header>

<main id="orders"></main>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-auth.js";
import { getFirestore, collection, getDocs, doc, updateDoc } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCIaWncAaVr4Jezf5rzbCwUza3rtIB1gXw",
  authDomain: "fastuc-25614.firebaseapp.com",
  projectId: "fastuc-25614"
};

const ADMIN_UID = "PUT_YOUR_UID_HERE";

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);
const ordersDiv = document.getElementById("orders");

onAuthStateChanged(auth, async user => {
  if (!user || user.uid !== ADMIN_UID) {
    alert("غير مصرح");
    return location.href = "index.html";
  }

  const snap = await getDocs(collection(db, "orders"));
  ordersDiv.innerHTML = "";

  snap.forEach(docu => {
    const o = docu.data();
    ordersDiv.innerHTML += `
      <div class="package">
        <p>PUBG ID: ${o.pubgId}</p>
        <p>الحالة: ${o.status}</p>
        <button onclick="confirmPay('${docu.id}')">تأكيد الدفع</button>
        <button onclick="charge('${docu.id}')">تم الشحن</button>
      </div>
    `;
  });
});

window.confirmPay = async (id) => {
  await updateDoc(doc(db, "orders", id), { status: "paid" });
  alert("تم تأكيد الدفع");
};

window.charge = async (id) => {
  await updateDoc(doc(db, "orders", id), { status: "completed" });
  alert("تم الشحن ✔️");
};
</script>
</body>
</html>
